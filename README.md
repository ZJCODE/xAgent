# iLanguage - AIé©±åŠ¨çš„æ™ºèƒ½è‹±è¯­å­¦ä¹ å¹³å°

[![Python](https://img.shields.io/badge/Python-3.12+-blue.svg)](https://python.org)
[![FastAPI](https://img.shields.io/badge/FastAPI-Latest-green.svg)](https://fastapi.tiangolo.com)
[![OpenAI](https://img.shields.io/badge/OpenAI-GPT--4o-orange.svg)](https://openai.com)
[![Redis](https://img.shields.io/badge/Redis-Latest-red.svg)](https://redis.io)
[![Streamlit](https://img.shields.io/badge/Streamlit-Latest-ff6b6b.svg)](https://streamlit.io)

## ğŸ¯ é¡¹ç›®ç®€ä»‹

iLanguage æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„AIé©±åŠ¨æ™ºèƒ½è‹±è¯­å­¦ä¹ å¹³å°ï¼Œé›†æˆäº†**è¯æ±‡å­¦ä¹ **ã€**æ™ºèƒ½å¯¹è¯**ã€**ä¸ªæ€§åŒ–æ¨è**ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–å¾®æœåŠ¡æ¶æ„ï¼Œæä¾›RESTful APIæœåŠ¡å’Œäº¤äº’å¼Webç•Œé¢ï¼Œä¸ºç”¨æˆ·æä¾›æ²‰æµ¸å¼çš„è‹±è¯­å­¦ä¹ ä½“éªŒã€‚

### âœ¨ æ ¸å¿ƒç‰¹è‰²
- ğŸ¤– **AIæ™ºèƒ½åŠ©æ‰‹**ï¼šåŸºäºOpenAI GPT-4oçš„æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ
- ğŸ“š **æ™ºèƒ½è¯æ±‡å­¦ä¹ **ï¼šAIé©±åŠ¨çš„è¯æ±‡æŸ¥è¯¢ã€è§£é‡Šå’Œç®¡ç†
- ğŸ¨ **å¤šæ¨¡æ€äº¤äº’**ï¼šæ”¯æŒæ–‡æœ¬å¯¹è¯ã€å›¾åƒç”Ÿæˆã€ç½‘ç»œæœç´¢
- ğŸ“Š **ä¸ªæ€§åŒ–æ¨è**ï¼šåŸºäºå­¦ä¹ è¡Œä¸ºçš„æ™ºèƒ½è¯æ±‡æ¨èç®—æ³•
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**ï¼šRediså­˜å‚¨ï¼Œæ”¯æŒç”¨æˆ·å­¦ä¹ è®°å½•è¿½è¸ª
- ğŸŒ **åŒç•Œé¢æ”¯æŒ**ï¼šRESTful API + Streamlit Webç•Œé¢

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒæ¨¡å—

#### ğŸ§  AIå¯¹è¯ç³»ç»Ÿ
- **Sessionç®¡ç†**ï¼šæ”¯æŒå¤šç”¨æˆ·ã€å¤šä¼šè¯çš„æ¶ˆæ¯å†å²ç®¡ç†
- **Agentæ¡†æ¶**ï¼šå¼‚æ­¥AIä»£ç†ï¼Œæ”¯æŒå·¥å…·è°ƒç”¨å’Œå‡½æ•°æ‰§è¡Œ
- **å·¥å…·é›†æˆ**ï¼šè¯æ±‡æŸ¥è¯¢ã€ç½‘ç»œæœç´¢ã€å›¾åƒç”Ÿæˆç­‰å†…ç½®å·¥å…·
- **å­˜å‚¨çµæ´»æ€§**ï¼šæ”¯æŒå†…å­˜å­˜å‚¨å’ŒRedisæŒä¹…åŒ–ä¸¤ç§æ¨¡å¼

#### ğŸ“– æ™ºèƒ½è¯æ±‡ç³»ç»Ÿ
- **AIè¯æ±‡è§£é‡Š**ï¼šåŸºäºGPT-4oçš„æ™ºèƒ½è¯æ±‡å®šä¹‰å’Œä¾‹å¥ç”Ÿæˆ
- **éš¾åº¦åˆ†çº§**ï¼šè‡ªåŠ¨è¯†åˆ«è¯æ±‡éš¾åº¦ï¼ˆåˆçº§/ä¸­çº§/é«˜çº§/ä¸“å®¶ï¼‰
- **ç†Ÿæ‚‰åº¦è¿½è¸ª**ï¼š0-10çº§ç†Ÿæ‚‰åº¦è¯„åˆ†å’Œå­¦ä¹ è¿›åº¦è¿½è¸ª
- **æ™ºèƒ½æ¨è**ï¼šåŸºäºé—å¿˜æ›²çº¿å’Œå¤šç»´åº¦å› ç´ çš„å¤ä¹ æ¨è

#### ğŸ¨ å¤šæ¨¡æ€åŠŸèƒ½
- **å›¾åƒç”Ÿæˆ**ï¼šé›†æˆDALL-Eå›¾åƒç”ŸæˆåŠŸèƒ½
- **ç½‘ç»œæœç´¢**ï¼šå®æ—¶ä¿¡æ¯æ£€ç´¢å’Œå†…å®¹è·å–
- **æ•°å­¦è®¡ç®—**ï¼šå†…ç½®è®¡ç®—å·¥å…·æ”¯æŒ

### æŠ€æœ¯æ ˆ

#### åç«¯æ ¸å¿ƒ
- **FastAPI** - é«˜æ€§èƒ½å¼‚æ­¥Webæ¡†æ¶
- **Uvicorn** - ASGIæœåŠ¡å™¨
- **Pydantic** - æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
- **AsyncIO** - å¼‚æ­¥ç¼–ç¨‹æ”¯æŒ

#### AIæœåŠ¡
- **OpenAI GPT-4o/GPT-4o-mini** - å¤§è¯­è¨€æ¨¡å‹
- **DALL-E** - å›¾åƒç”Ÿæˆæ¨¡å‹
- **Langfuse** - AIåº”ç”¨ç›‘æ§å’Œè¿½è¸ª
- **Tenacity** - é‡è¯•æœºåˆ¶å’Œé”™è¯¯å¤„ç†

#### æ•°æ®å­˜å‚¨
- **Redis** - é«˜æ€§èƒ½ç¼“å­˜å’Œæ•°æ®æŒä¹…åŒ–
- **Python-dotenv** - ç¯å¢ƒå˜é‡ç®¡ç†

#### å‰ç«¯ç•Œé¢
- **Streamlit** - äº¤äº’å¼Webåº”ç”¨æ¡†æ¶
- **ç°ä»£åŒ–UI** - å“åº”å¼è®¾è®¡å’Œç”¨æˆ·ä½“éªŒä¼˜åŒ–

#### å¼€å‘å·¥å…·
- **Pytest** - å®Œæ•´çš„å•å…ƒæµ‹è¯•è¦†ç›–
- **åˆ†å±‚æ¶æ„** - æ¸…æ™°çš„ä»£ç ç»„ç»‡å’Œæ¨¡å—åŒ–è®¾è®¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
iLanguage/
â”œâ”€â”€ ğŸ—ï¸ æ ¸å¿ƒä¸šåŠ¡å±‚
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ agent.py          # AIå¯¹è¯ä»£ç†æ ¸å¿ƒç±»
â”‚   â”‚   â”œâ”€â”€ vocabulary.py     # è¯æ±‡æœåŠ¡æ ¸å¿ƒç±»
â”‚   â”‚   â””â”€â”€ base.py          # åŸºç¡€æœåŠ¡ç±»
â”‚   â””â”€â”€ tools/               # å·¥å…·å‡½æ•°é›†
â”‚       â”œâ”€â”€ vocabulary_tool.py # è¯æ±‡æŸ¥è¯¢å·¥å…·
â”‚       â””â”€â”€ openai_tool.py    # OpenAIé›†æˆå·¥å…·
â”œâ”€â”€ ğŸŒ APIæœåŠ¡å±‚
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ vocabulary.py     # è¯æ±‡ç›¸å…³æ¥å£
â”‚   â”‚   â””â”€â”€ health.py        # å¥åº·æ£€æŸ¥æ¥å£
â”‚   â””â”€â”€ main.py              # FastAPIåº”ç”¨å…¥å£
â”œâ”€â”€ ğŸ’¾ æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ vocabulary_db.py  # è¯æ±‡æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â””â”€â”€ message_db.py    # æ¶ˆæ¯æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ schemas/             # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚       â”œâ”€â”€ vocabulary.py     # è¯æ±‡æ•°æ®æ¨¡å‹
â”‚       â””â”€â”€ messages.py      # æ¶ˆæ¯æ•°æ®æ¨¡å‹
â”œâ”€â”€ ğŸ–¥ï¸ å‰ç«¯ç•Œé¢
â”‚   â””â”€â”€ frontend/
â”‚       â””â”€â”€ chat_app.py      # Streamlitå¯¹è¯ç•Œé¢
â”œâ”€â”€ ğŸ§ª æµ‹è¯•æ¨¡å—
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ test_vocabulary_db.py
â”‚       â”œâ”€â”€ test_message_db.py
â”‚       â””â”€â”€ test_redis_basic.py
â”œâ”€â”€ ğŸ”§ å·¥å…·å’Œé…ç½®
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ tool_decorator.py # å·¥å…·è£…é¥°å™¨
â”‚   â”œâ”€â”€ requirements.txt     # é¡¹ç›®ä¾èµ–
â”‚   â”œâ”€â”€ .env                 # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â””â”€â”€ README.md           # é¡¹ç›®æ–‡æ¡£
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿ä½ çš„ç³»ç»Ÿå·²å®‰è£…ï¼š
- Python 3.12+
- Redis æœåŠ¡å™¨
- OpenAI API è®¿é—®æƒé™

### 2. å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd iLanguage

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3. ç¯å¢ƒå˜é‡é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# OpenAI API é…ç½®
OPENAI_API_KEY=your_openai_api_key_here

# Redis é…ç½®
REDIS_URL=redis://localhost:6379/0

# Langfuse é…ç½®ï¼ˆå¯é€‰ï¼‰
LANGFUSE_PUBLIC_KEY=your_langfuse_public_key
LANGFUSE_SECRET_KEY=your_langfuse_secret_key
LANGFUSE_HOST=https://cloud.langfuse.com
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼1ï¼šç›´æ¥è¿è¡Œ
python main.py

# æ–¹å¼2ï¼šä½¿ç”¨ uvicorn
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### 5. è®¿é—®æœåŠ¡

- **API æ–‡æ¡£**ï¼šhttp://localhost:8000/docs
- **å¥åº·æ£€æŸ¥**ï¼šhttp://localhost:8000/health
- **è¯æ±‡æŸ¥è¯¢ç¤ºä¾‹**ï¼šPOST http://localhost:8000/lookup

## API æ¥å£æ–‡æ¡£

### è¯æ±‡æŸ¥è¯¢æ¥å£

#### POST /lookup
æŸ¥è¯¢å•è¯è¯¦ç»†ä¿¡æ¯ï¼Œæ”¯æŒç¼“å­˜å’Œä¸ªæ€§åŒ–å­˜å‚¨ã€‚

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "word": "sophisticated",
  "user_id": "user123",
  "cache": true
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "word": "sophisticated",
  "explanation": "Having great knowledge or experience; complex and refined",
  "example_sentences": [
    "She has a sophisticated understanding of art.",
    "The software uses sophisticated algorithms."
  ],
  "difficulty_level": "advanced",
  "user_id": "user123",
  "familiarity": 0,
  "create_timestamp": 1642694400.0,
  "update_timestamp": 1642694400.0
}
```

#### POST /get_vocabulary
è·å–ç”¨æˆ·éœ€è¦å¤ä¹ çš„è¯æ±‡åˆ—è¡¨ã€‚

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "user_id": "user123",
  "n": 10,
  "exclude_known": false
}
```

### å¥åº·æ£€æŸ¥æ¥å£

#### GET /health
æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€ã€‚

## æ•°æ®æ¨¡å‹

### è¯æ±‡éš¾åº¦ç­‰çº§
- `BEGINNER` - åˆçº§ï¼ˆA1-A2ï¼‰
- `INTERMEDIATE` - ä¸­çº§ï¼ˆB1-B2ï¼‰
- `ADVANCED` - é«˜çº§ï¼ˆC1-C2ï¼‰
- `EXPERT` - ä¸“å®¶çº§

### è¯æ±‡è®°å½•å­—æ®µ
- `word` - è¯æ±‡ï¼ˆå°å†™ï¼‰
- `explanation` - è¯æ±‡è§£é‡Š
- `example_sentences` - ä¾‹å¥åˆ—è¡¨
- `difficulty_level` - éš¾åº¦ç­‰çº§
- `familiarity` - ç†Ÿæ‚‰åº¦ï¼ˆ0-10ï¼‰
- `create_timestamp` - åˆ›å»ºæ—¶é—´
- `update_timestamp` - æ›´æ–°æ—¶é—´
- `last_reviewed_timestamp` - æœ€åå¤ä¹ æ—¶é—´


## è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest test/test_vocabulary_db.py

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¦†ç›–ç‡
pytest --cov=core --cov=db --cov=api

# è¯¦ç»†æµ‹è¯•è¾“å‡º
pytest -v
```

## å¼€å‘æŒ‡å—

### ä»£ç ç»“æ„
- **åˆ†å±‚æ¶æ„**ï¼šæ¸…æ™°çš„ä¸šåŠ¡é€»è¾‘åˆ†ç¦»
- **ä¾èµ–æ³¨å…¥**ï¼šä¾¿äºæµ‹è¯•å’Œæ‰©å±•
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **æ—¥å¿—ç›‘æ§**ï¼šé›†æˆ Langfuse è¿½è¸ª

### æ‰©å±•å»ºè®®
1. åœ¨ `core/` ç›®å½•æ·»åŠ æ–°çš„ä¸šåŠ¡é€»è¾‘
2. åœ¨ `api/` ç›®å½•æ·»åŠ æ–°çš„è·¯ç”±æ¥å£
3. åœ¨ `schemas/` ç›®å½•å®šä¹‰æ•°æ®æ¨¡å‹
4. åœ¨ `test/` ç›®å½•æ·»åŠ å¯¹åº”æµ‹è¯•

### ç¯å¢ƒå˜é‡
```bash
# å¼€å‘ç¯å¢ƒæ¨èè®¾ç½®
export PYTHONPATH=$(pwd)
export ENVIRONMENT=development
```

## ä¾èµ–è¯´æ˜

| ä¾èµ–åŒ… | ç‰ˆæœ¬è¦æ±‚ | ç”¨é€” |
|--------|----------|------|
| fastapi | latest | Web æ¡†æ¶ |
| uvicorn | latest | ASGI æœåŠ¡å™¨ |
| pydantic | latest | æ•°æ®éªŒè¯ |
| redis | latest | æ•°æ®å­˜å‚¨ |
| openai | latest | AI æœåŠ¡ |
| langfuse | latest | AI ç›‘æ§ |
| tenacity | latest | é‡è¯•æœºåˆ¶ |
| python-dotenv | latest | ç¯å¢ƒå˜é‡ |
| pytest | latest | æµ‹è¯•æ¡†æ¶ |

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ LICENSE æ–‡ä»¶ã€‚

## è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue
- å‘é€é‚®ä»¶
- å‚ä¸è®¨è®º